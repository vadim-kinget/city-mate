<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - CityMate</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6c5ce7">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%236c5ce7'/><text x='50' y='65' font-family='Arial, sans-serif' font-weight='bold' font-size='50' fill='white' text-anchor='middle'>CM</text></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav>
        <a href="index.html" class="logo">City<span>Mate</span></a>
        
        <div class="nav-links">
            <a href="index.html">
                <span class="nav-icon">ğŸ—ºï¸</span>
                <span class="nav-text">Map</span>
            </a>
            <a href="guides.html">
                <span class="nav-icon">ğŸ“–</span>
                <span class="nav-text">Guides</span>
            </a>
            <a href="deals.html">
                <span class="nav-icon">ğŸ·ï¸</span>
                <span class="nav-text">Deals</span>
            </a>
            <a href="community.html">
                <span class="nav-icon">ğŸ‘¥</span>
                <span class="nav-text">Community</span>
            </a>
        </div>

        <div class="nav-right" style="display: flex; align-items: center; gap: 15px;">
            <button id="chat-toggle" class="chat-btn">
                ğŸ’¬ <span class="notif-badge">2</span>
            </button>
            <a href="profile.html" class="user-profile active">
                <div class="avatar"></div>
                <span>Alex</span>
            </a>
        </div>
    </nav>

    <div class="profile-container">
        
        <div class="profile-header-card">
            <div class="profile-top">
                <div class="big-avatar"></div>
                <div class="profile-info">
                    <h1>Alex Doe</h1>
                    <p class="school-tag">ğŸ“ Student at University of Lille</p>
                    <p class="join-date">Member since Sept. 2025</p>
                </div>
                <div class="settings-dropdown-wrapper">
                    <button id="settings-btn" class="edit-btn">âš™ï¸ Settings</button>
                    
                    <div id="settings-menu" class="dropdown-menu">
                        <a href="#" class="dropdown-item">ğŸ‘¤ Edit Profile</a>
                        <a href="#" class="dropdown-item">ğŸ”” Notifications</a>
                        <a href="#" class="dropdown-item">ğŸŒ™ Dark Mode</a>
                        <div class="dropdown-divider"></div> <a href="#" id="reset-app-btn" class="dropdown-item text-danger">âš ï¸ Reset App</a>
                    </div>
                </div>
            </div>

            <div class="level-section">
                <div class="level-info">
                    <span>Level 5 ğŸŒŸ</span>
                    <span>1,250 / 2,000 XP</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 65%;"></div>
                </div>
                <p class="next-reward">Next reward: Free Coffee at Level 6 â˜•</p>
            </div>
        </div>

        <div class="dashboard-grid">
            
            <div class="dash-card">
                <h3>ğŸ† My Badges</h3>
                <div class="badges-row">
                    <div class="badge-item" title="First Event Hosted">
                        <div class="badge-icon bg-purple">ğŸ¤</div>
                        <span>Host</span>
                    </div>
                    <div class="badge-item" title="Used 5 Deals">
                        <div class="badge-icon bg-yellow">ğŸ·ï¸</div>
                        <span>Saver</span>
                    </div>
                    <div class="badge-item grayscale" title="Locked: Join 10 events">
                        <div class="badge-icon">ğŸš€</div>
                        <span>Social</span>
                    </div>
                </div>
            </div>

            <div class="dash-card">
                <h3>ğŸŸï¸ My Wallet</h3>
                <div class="wallet-list">
                    <div class="wallet-item">
                        <span class="wallet-icon">ğŸ”</span>
                        <div>
                            <strong>Big Fernand</strong>
                            <span class="code-small">YUMMY20</span>
                        </div>
                    </div>
                    <div class="wallet-item">
                        <span class="wallet-icon">ğŸ¬</span>
                        <div>
                            <strong>UGC CinÃ©</strong>
                            <span class="code-small">MOVIENIGHT</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dash-card full-width">
                <h3>ğŸ“… My Hosted Events</h3>
                <div class="my-events-list">
                    <div class="my-event">
                        <div class="event-status active">Active</div>
                        <strong>English Conversation Club</strong>
                        <span>ğŸ“ Gare Saint Sauveur â€¢ Tomorrow 18:00</span>
                        <button class="manage-btn">Manage</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="chat-drawer" class="chat-drawer">
        <div class="chat-header">
            <h3>Messages</h3>
            <button id="close-chat" class="close-btn">&times;</button>
        </div>
        <div id="chat-list-view" class="chat-view active">
            <div class="conversations-list">
                <div class="convo-item">
                    <div class="convo-avatar bg-purple">ğŸ¨</div>
                    <div class="convo-info">
                        <h4>Museum Lovers</h4>
                        <p>Welcome to the group!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatDrawer = document.getElementById('chat-drawer');
            const chatToggle = document.getElementById('chat-toggle');
            const closeChatBtn = document.getElementById('close-chat');

            if (chatToggle && chatDrawer) {
                chatToggle.addEventListener('click', () => chatDrawer.classList.add('open'));
                if (closeChatBtn) closeChatBtn.addEventListener('click', () => chatDrawer.classList.remove('open'));
                chatDrawer.addEventListener('click', (e) => { if (e.target === chatDrawer) chatDrawer.classList.remove('open'); });
            }
        });

        // --- GESTION DU MENU DÃ‰ROULANT ---

        const settingsBtn = document.getElementById('settings-btn');
        const settingsMenu = document.getElementById('settings-menu');
        const resetBtn = document.getElementById('reset-app-btn');

        if (settingsBtn && settingsMenu) {
            
            // 1. Ouvrir / Fermer le menu au clic
            settingsBtn.addEventListener('click', (e) => {
                e.stopPropagation(); // EmpÃªche de fermer tout de suite
                settingsMenu.classList.toggle('show');
            });

            // 2. Fermer le menu si on clique ailleurs sur la page
            document.addEventListener('click', (e) => {
                if (!settingsMenu.contains(e.target) && e.target !== settingsBtn) {
                    settingsMenu.classList.remove('show');
                }
            });

            // 3. Action : Reset App (La seule qui marche pour l'instant)
            if (resetBtn) {
                resetBtn.addEventListener('click', (e) => {
                    e.preventDefault(); // EmpÃªche le lien de recharger la page
                    
                    if (confirm("âš ï¸ Warning\n\nThis will delete all your created events and reset the app. Are you sure?")) {
                        localStorage.removeItem('citymate_events');
                        alert("App reset successfully! ğŸ§¹");
                        window.location.href = "index.html";
                    }
                });
            }
            
            // 4. Action : Les autres boutons (Placeholders)
            const otherLinks = settingsMenu.querySelectorAll('.dropdown-item:not(#reset-app-btn)');
            otherLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    alert("Coming soon! ğŸš§");
                });
            });
        }
    </script>
</body>
</html>